{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"]}},{"name":"../utils/rnlibraries","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":58},"end":{"line":2,"column":60,"index":118}}],"key":"fGrlZFgrYQrfU1K4tN9OULy4C5Q=","exportNames":["*"]}},{"name":"../utils/xhr","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":119},"end":{"line":3,"column":69,"index":188}}],"key":"vOZixZXnOl9wEw9+pZF/CmKTIq4=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getDefaultSidecarUrl = getDefaultSidecarUrl;\n  exports.spotlightIntegration = spotlightIntegration;\n  var _core = require(_dependencyMap[0], \"@sentry/core\");\n  var _rnlibraries = require(_dependencyMap[1], \"../utils/rnlibraries\");\n  var _xhr = require(_dependencyMap[2], \"../utils/xhr\");\n  /**\n   * Use this integration to send errors and transactions to Spotlight.\n   *\n   * Learn more about spotlight at https://spotlightjs.com\n   */\n  function spotlightIntegration({\n    sidecarUrl = getDefaultSidecarUrl()\n  } = {}) {\n    _core.logger.info('[Spotlight] Using Sidecar URL', sidecarUrl);\n    return {\n      name: 'Spotlight',\n      setupOnce() {\n        // nothing to do here\n      },\n      setup(client) {\n        setup(client, sidecarUrl);\n      }\n    };\n  }\n  function setup(client, sidecarUrl) {\n    sendEnvelopesToSidecar(client, sidecarUrl);\n  }\n  function sendEnvelopesToSidecar(client, sidecarUrl) {\n    if (!client.on) {\n      return;\n    }\n    client.on('beforeEnvelope', originalEnvelope => {\n      // TODO: This is a workaround for spotlight/sidecar not supporting images\n      const spotlightEnvelope = [...originalEnvelope];\n      const envelopeItems = [...originalEnvelope[1]].filter(item => typeof item[0].content_type !== 'string' || !item[0].content_type.startsWith('image'));\n      spotlightEnvelope[1] = envelopeItems;\n      const xhr = (0, _xhr.createStealthXhr)();\n      if (!xhr) {\n        _core.logger.error('[Spotlight] Sentry SDK can not create XHR object');\n        return;\n      }\n      xhr.open('POST', sidecarUrl, true);\n      xhr.setRequestHeader('Content-Type', 'application/x-sentry-envelope');\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === _xhr.XHR_READYSTATE_DONE) {\n          const status = xhr.status;\n          if (status === 0 || status >= 200 && status < 400) {\n            // The request has been completed successfully\n          } else {\n            // Handle the error\n            _core.logger.error(\"[Spotlight] Sentry SDK can't connect to Spotlight is it running? See https://spotlightjs.com to download it.\", new Error(xhr.statusText));\n          }\n        }\n      };\n      xhr.send((0, _core.serializeEnvelope)(spotlightEnvelope));\n    });\n  }\n  /**\n   * Gets the default Spotlight sidecar URL.\n   */\n  function getDefaultSidecarUrl() {\n    var _a;\n    try {\n      const {\n        url\n      } = (_a = _rnlibraries.ReactNativeLibraries.Devtools) === null || _a === void 0 ? void 0 : _a.getDevServer();\n      return `http://${getHostnameFromString(url)}:8969/stream`;\n    } catch (_oO) {\n      // We can't load devserver URL\n    }\n    return 'http://localhost:8969/stream';\n  }\n  /**\n   * React Native implementation of the URL class is missing the `hostname` property.\n   */\n  function getHostnameFromString(urlString) {\n    const regex = /^(?:\\w+:)?\\/\\/([^/:]+)(:\\d+)?(.*)$/;\n    const matches = urlString.match(regex);\n    if (matches && matches[1]) {\n      return matches[1];\n    } else {\n      // Invalid URL format\n      return null;\n    }\n  }\n});","lineCount":90,"map":[[7,2,1,0],[7,6,1,0,"_core"],[7,11,1,0],[7,14,1,0,"require"],[7,21,1,0],[7,22,1,0,"_dependencyMap"],[7,36,1,0],[8,2,2,0],[8,6,2,0,"_rnlibraries"],[8,18,2,0],[8,21,2,0,"require"],[8,28,2,0],[8,29,2,0,"_dependencyMap"],[8,43,2,0],[9,2,3,0],[9,6,3,0,"_xhr"],[9,10,3,0],[9,13,3,0,"require"],[9,20,3,0],[9,21,3,0,"_dependencyMap"],[9,35,3,0],[10,2,4,0],[11,0,5,0],[12,0,6,0],[13,0,7,0],[14,0,8,0],[15,2,9,7],[15,11,9,16,"spotlightIntegration"],[15,31,9,36,"spotlightIntegration"],[15,32,9,37],[16,4,9,39,"sidecarUrl"],[16,14,9,49],[16,17,9,52,"getDefaultSidecarUrl"],[16,37,9,72],[16,38,9,73],[17,2,9,76],[17,3,9,77],[17,6,9,80],[17,7,9,81],[17,8,9,82],[17,10,9,84],[18,4,10,4,"logger"],[18,16,10,10],[18,17,10,11,"info"],[18,21,10,15],[18,22,10,16],[18,53,10,47],[18,55,10,49,"sidecarUrl"],[18,65,10,59],[18,66,10,60],[19,4,11,4],[19,11,11,11],[20,6,12,8,"name"],[20,10,12,12],[20,12,12,14],[20,23,12,25],[21,6,13,8,"setupOnce"],[21,15,13,17,"setupOnce"],[21,16,13,17],[21,18,13,20],[22,8,14,12],[23,6,14,12],[23,7,15,9],[24,6,16,8,"setup"],[24,11,16,13,"setup"],[24,12,16,14,"client"],[24,18,16,20],[24,20,16,22],[25,8,17,12,"setup"],[25,13,17,17],[25,14,17,18,"client"],[25,20,17,24],[25,22,17,26,"sidecarUrl"],[25,32,17,36],[25,33,17,37],[26,6,18,8],[27,4,19,4],[27,5,19,5],[28,2,20,0],[29,2,21,0],[29,11,21,9,"setup"],[29,16,21,14,"setup"],[29,17,21,15,"client"],[29,23,21,21],[29,25,21,23,"sidecarUrl"],[29,35,21,33],[29,37,21,35],[30,4,22,4,"sendEnvelopesToSidecar"],[30,26,22,26],[30,27,22,27,"client"],[30,33,22,33],[30,35,22,35,"sidecarUrl"],[30,45,22,45],[30,46,22,46],[31,2,23,0],[32,2,24,0],[32,11,24,9,"sendEnvelopesToSidecar"],[32,33,24,31,"sendEnvelopesToSidecar"],[32,34,24,32,"client"],[32,40,24,38],[32,42,24,40,"sidecarUrl"],[32,52,24,50],[32,54,24,52],[33,4,25,4],[33,8,25,8],[33,9,25,9,"client"],[33,15,25,15],[33,16,25,16,"on"],[33,18,25,18],[33,20,25,20],[34,6,26,8],[35,4,27,4],[36,4,28,4,"client"],[36,10,28,10],[36,11,28,11,"on"],[36,13,28,13],[36,14,28,14],[36,30,28,30],[36,32,28,33,"originalEnvelope"],[36,48,28,49],[36,52,28,54],[37,6,29,8],[38,6,30,8],[38,12,30,14,"spotlightEnvelope"],[38,29,30,31],[38,32,30,34],[38,33,30,35],[38,36,30,38,"originalEnvelope"],[38,52,30,54],[38,53,30,55],[39,6,31,8],[39,12,31,14,"envelopeItems"],[39,25,31,27],[39,28,31,30],[39,29,31,31],[39,32,31,34,"originalEnvelope"],[39,48,31,50],[39,49,31,51],[39,50,31,52],[39,51,31,53],[39,52,31,54],[39,53,31,55,"filter"],[39,59,31,61],[39,60,31,62,"item"],[39,64,31,66],[39,68,31,70],[39,75,31,77,"item"],[39,79,31,81],[39,80,31,82],[39,81,31,83],[39,82,31,84],[39,83,31,85,"content_type"],[39,95,31,97],[39,100,31,102],[39,108,31,110],[39,112,31,114],[39,113,31,115,"item"],[39,117,31,119],[39,118,31,120],[39,119,31,121],[39,120,31,122],[39,121,31,123,"content_type"],[39,133,31,135],[39,134,31,136,"startsWith"],[39,144,31,146],[39,145,31,147],[39,152,31,154],[39,153,31,155],[39,154,31,156],[40,6,32,8,"spotlightEnvelope"],[40,23,32,25],[40,24,32,26],[40,25,32,27],[40,26,32,28],[40,29,32,31,"envelopeItems"],[40,42,32,44],[41,6,33,8],[41,12,33,14,"xhr"],[41,15,33,17],[41,18,33,20],[41,22,33,20,"createStealthXhr"],[41,43,33,36],[41,45,33,37],[41,46,33,38],[42,6,34,8],[42,10,34,12],[42,11,34,13,"xhr"],[42,14,34,16],[42,16,34,18],[43,8,35,12,"logger"],[43,20,35,18],[43,21,35,19,"error"],[43,26,35,24],[43,27,35,25],[43,77,35,75],[43,78,35,76],[44,8,36,12],[45,6,37,8],[46,6,38,8,"xhr"],[46,9,38,11],[46,10,38,12,"open"],[46,14,38,16],[46,15,38,17],[46,21,38,23],[46,23,38,25,"sidecarUrl"],[46,33,38,35],[46,35,38,37],[46,39,38,41],[46,40,38,42],[47,6,39,8,"xhr"],[47,9,39,11],[47,10,39,12,"setRequestHeader"],[47,26,39,28],[47,27,39,29],[47,41,39,43],[47,43,39,45],[47,74,39,76],[47,75,39,77],[48,6,40,8,"xhr"],[48,9,40,11],[48,10,40,12,"onreadystatechange"],[48,28,40,30],[48,31,40,33],[48,43,40,45],[49,8,41,12],[49,12,41,16,"xhr"],[49,15,41,19],[49,16,41,20,"readyState"],[49,26,41,30],[49,31,41,35,"XHR_READYSTATE_DONE"],[49,55,41,54],[49,57,41,56],[50,10,42,16],[50,16,42,22,"status"],[50,22,42,28],[50,25,42,31,"xhr"],[50,28,42,34],[50,29,42,35,"status"],[50,35,42,41],[51,10,43,16],[51,14,43,20,"status"],[51,20,43,26],[51,25,43,31],[51,26,43,32],[51,30,43,37,"status"],[51,36,43,43],[51,40,43,47],[51,43,43,50],[51,47,43,54,"status"],[51,53,43,60],[51,56,43,63],[51,59,43,67],[51,61,43,69],[52,12,44,20],[53,10,44,20],[53,11,45,17],[53,17,46,21],[54,12,47,20],[55,12,48,20,"logger"],[55,24,48,26],[55,25,48,27,"error"],[55,30,48,32],[55,31,48,33],[55,141,48,143],[55,143,48,145],[55,147,48,149,"Error"],[55,152,48,154],[55,153,48,155,"xhr"],[55,156,48,158],[55,157,48,159,"statusText"],[55,167,48,169],[55,168,48,170],[55,169,48,171],[56,10,49,16],[57,8,50,12],[58,6,51,8],[58,7,51,9],[59,6,52,8,"xhr"],[59,9,52,11],[59,10,52,12,"send"],[59,14,52,16],[59,15,52,17],[59,19,52,17,"serializeEnvelope"],[59,42,52,34],[59,44,52,35,"spotlightEnvelope"],[59,61,52,52],[59,62,52,53],[59,63,52,54],[60,4,53,4],[60,5,53,5],[60,6,53,6],[61,2,54,0],[62,2,55,0],[63,0,56,0],[64,0,57,0],[65,2,58,7],[65,11,58,16,"getDefaultSidecarUrl"],[65,31,58,36,"getDefaultSidecarUrl"],[65,32,58,36],[65,34,58,39],[66,4,59,4],[66,8,59,8,"_a"],[66,10,59,10],[67,4,60,4],[67,8,60,8],[68,6,61,8],[68,12,61,14],[69,8,61,16,"url"],[70,6,61,20],[70,7,61,21],[70,10,61,24],[70,11,61,25,"_a"],[70,13,61,27],[70,16,61,30,"ReactNativeLibraries"],[70,49,61,50],[70,50,61,51,"Devtools"],[70,58,61,59],[70,64,61,65],[70,68,61,69],[70,72,61,73,"_a"],[70,74,61,75],[70,79,61,80],[70,84,61,85],[70,85,61,86],[70,88,61,89],[70,93,61,94],[70,94,61,95],[70,97,61,98,"_a"],[70,99,61,100],[70,100,61,101,"getDevServer"],[70,112,61,113],[70,113,61,114],[70,114,61,115],[71,6,62,8],[71,13,62,15],[71,23,62,25,"getHostnameFromString"],[71,44,62,46],[71,45,62,47,"url"],[71,48,62,50],[71,49,62,51],[71,63,62,65],[72,4,63,4],[72,5,63,5],[72,6,64,4],[72,13,64,11,"_oO"],[72,16,64,14],[72,18,64,16],[73,6,65,8],[74,4,65,8],[75,4,67,4],[75,11,67,11],[75,41,67,41],[76,2,68,0],[77,2,69,0],[78,0,70,0],[79,0,71,0],[80,2,72,0],[80,11,72,9,"getHostnameFromString"],[80,32,72,30,"getHostnameFromString"],[80,33,72,31,"urlString"],[80,42,72,40],[80,44,72,42],[81,4,73,4],[81,10,73,10,"regex"],[81,15,73,15],[81,18,73,18],[81,54,73,54],[82,4,74,4],[82,10,74,10,"matches"],[82,17,74,17],[82,20,74,20,"urlString"],[82,29,74,29],[82,30,74,30,"match"],[82,35,74,35],[82,36,74,36,"regex"],[82,41,74,41],[82,42,74,42],[83,4,75,4],[83,8,75,8,"matches"],[83,15,75,15],[83,19,75,19,"matches"],[83,26,75,26],[83,27,75,27],[83,28,75,28],[83,29,75,29],[83,31,75,31],[84,6,76,8],[84,13,76,15,"matches"],[84,20,76,22],[84,21,76,23],[84,22,76,24],[84,23,76,25],[85,4,77,4],[85,5,77,5],[85,11,78,9],[86,6,79,8],[87,6,80,8],[87,13,80,15],[87,17,80,19],[88,4,81,4],[89,2,82,0],[90,0,82,1],[90,3]],"functionMap":{"names":["<global>","spotlightIntegration","setupOnce","setup","sendEnvelopesToSidecar","client.on$argument_1","filter$argument_0","xhr.onreadystatechange","getDefaultSidecarUrl","getHostnameFromString"],"mappings":"AAA;OCQ;QCI;SDE;QEC;SFE;CDE;AGC;CHE;AIC;gCCI;8DCG,6FD;iCES;SFW;KDE;CJC;OQI;CRU;ASI;CTU"}},"type":"js/module"}]}