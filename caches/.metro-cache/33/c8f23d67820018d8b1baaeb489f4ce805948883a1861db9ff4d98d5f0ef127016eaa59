{"dependencies":[{"name":"@sentry/core","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":106,"index":106}}],"key":"/o+dASQcHF2bB25icdsM0E4TExc=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.applySourceContextToFrame = applySourceContextToFrame;\n  exports.contextLinesIntegration = void 0;\n  var _core = require(_dependencyMap[0], \"@sentry/core\");\n  const WINDOW = _core.GLOBAL_OBJ;\n  const DEFAULT_LINES_OF_CONTEXT = 7;\n  const INTEGRATION_NAME = 'ContextLines';\n  const _contextLinesIntegration = (options = {}) => {\n    const contextLines = options.frameContextLines != null ? options.frameContextLines : DEFAULT_LINES_OF_CONTEXT;\n    return {\n      name: INTEGRATION_NAME,\n      processEvent(event) {\n        return addSourceContext(event, contextLines);\n      }\n    };\n  };\n\n  /**\n   * Collects source context lines around the lines of stackframes pointing to JS embedded in\n   * the current page's HTML.\n   *\n   * This integration DOES NOT work for stack frames pointing to JS files that are loaded by the browser.\n   * For frames pointing to files, context lines are added during ingestion and symbolication\n   * by attempting to download the JS files to the Sentry backend.\n   *\n   * Use this integration if you have inline JS code in HTML pages that can't be accessed\n   * by our backend (e.g. due to a login-protected page).\n   */\n  const contextLinesIntegration = exports.contextLinesIntegration = (0, _core.defineIntegration)(_contextLinesIntegration);\n\n  /**\n   * Processes an event and adds context lines.\n   */\n  function addSourceContext(event, contextLines) {\n    const doc = WINDOW.document;\n    const htmlFilename = WINDOW.location && (0, _core.stripUrlQueryAndFragment)(WINDOW.location.href);\n    if (!doc || !htmlFilename) {\n      return event;\n    }\n    const exceptions = event.exception && event.exception.values;\n    if (!exceptions || !exceptions.length) {\n      return event;\n    }\n    const html = doc.documentElement.innerHTML;\n    if (!html) {\n      return event;\n    }\n    const htmlLines = ['<!DOCTYPE html>', '<html>', ...html.split('\\n'), '</html>'];\n    exceptions.forEach(exception => {\n      const stacktrace = exception.stacktrace;\n      if (stacktrace && stacktrace.frames) {\n        stacktrace.frames = stacktrace.frames.map(frame => applySourceContextToFrame(frame, htmlLines, htmlFilename, contextLines));\n      }\n    });\n    return event;\n  }\n\n  /**\n   * Only exported for testing\n   */\n  function applySourceContextToFrame(frame, htmlLines, htmlFilename, linesOfContext) {\n    if (frame.filename !== htmlFilename || !frame.lineno || !htmlLines.length) {\n      return frame;\n    }\n    (0, _core.addContextToFrame)(htmlLines, frame, linesOfContext);\n    return frame;\n  }\n});","lineCount":71,"map":[[7,2,1,0],[7,6,1,0,"_core"],[7,11,1,0],[7,14,1,0,"require"],[7,21,1,0],[7,22,1,0,"_dependencyMap"],[7,36,1,0],[8,2,3,0],[8,8,3,6,"WINDOW"],[8,14,3,12],[8,17,3,15,"GLOBAL_OBJ"],[8,33,3,25],[9,2,5,0],[9,8,5,6,"DEFAULT_LINES_OF_CONTEXT"],[9,32,5,30],[9,35,5,33],[9,36,5,34],[10,2,7,0],[10,8,7,6,"INTEGRATION_NAME"],[10,24,7,22],[10,27,7,25],[10,41,7,39],[11,2,9,0],[11,8,9,6,"_contextLinesIntegration"],[11,32,9,30],[11,35,9,34,"_contextLinesIntegration"],[11,36,9,35,"options"],[11,43,9,42],[11,46,9,45],[11,47,9,46],[11,48,9,47],[11,53,9,52],[12,4,10,2],[12,10,10,8,"contextLines"],[12,22,10,20],[12,25,10,23,"options"],[12,32,10,30],[12,33,10,31,"frameContextLines"],[12,50,10,48],[12,54,10,52],[12,58,10,56],[12,61,10,59,"options"],[12,68,10,66],[12,69,10,67,"frameContextLines"],[12,86,10,84],[12,89,10,87,"DEFAULT_LINES_OF_CONTEXT"],[12,113,10,111],[13,4,12,2],[13,11,12,9],[14,6,13,4,"name"],[14,10,13,8],[14,12,13,10,"INTEGRATION_NAME"],[14,28,13,26],[15,6,14,4,"processEvent"],[15,18,14,16,"processEvent"],[15,19,14,17,"event"],[15,24,14,22],[15,26,14,24],[16,8,15,6],[16,15,15,13,"addSourceContext"],[16,31,15,29],[16,32,15,30,"event"],[16,37,15,35],[16,39,15,37,"contextLines"],[16,51,15,49],[16,52,15,50],[17,6,16,4],[18,4,17,2],[18,5,17,3],[19,2,18,0],[19,3,18,2],[21,2,20,0],[22,0,21,0],[23,0,22,0],[24,0,23,0],[25,0,24,0],[26,0,25,0],[27,0,26,0],[28,0,27,0],[29,0,28,0],[30,0,29,0],[31,0,30,0],[32,2,31,0],[32,8,31,6,"contextLinesIntegration"],[32,31,31,29],[32,34,31,29,"exports"],[32,41,31,29],[32,42,31,29,"contextLinesIntegration"],[32,65,31,29],[32,68,31,32],[32,72,31,32,"defineIntegration"],[32,95,31,49],[32,97,31,50,"_contextLinesIntegration"],[32,121,31,74],[32,122,31,75],[34,2,33,0],[35,0,34,0],[36,0,35,0],[37,2,36,0],[37,11,36,9,"addSourceContext"],[37,27,36,25,"addSourceContext"],[37,28,36,26,"event"],[37,33,36,31],[37,35,36,33,"contextLines"],[37,47,36,45],[37,49,36,47],[38,4,37,2],[38,10,37,8,"doc"],[38,13,37,11],[38,16,37,14,"WINDOW"],[38,22,37,20],[38,23,37,21,"document"],[38,31,37,29],[39,4,38,2],[39,10,38,8,"htmlFilename"],[39,22,38,20],[39,25,38,23,"WINDOW"],[39,31,38,29],[39,32,38,30,"location"],[39,40,38,38],[39,44,38,42],[39,48,38,42,"stripUrlQueryAndFragment"],[39,78,38,66],[39,80,38,67,"WINDOW"],[39,86,38,73],[39,87,38,74,"location"],[39,95,38,82],[39,96,38,83,"href"],[39,100,38,87],[39,101,38,88],[40,4,39,2],[40,8,39,6],[40,9,39,7,"doc"],[40,12,39,10],[40,16,39,14],[40,17,39,15,"htmlFilename"],[40,29,39,27],[40,31,39,29],[41,6,40,4],[41,13,40,11,"event"],[41,18,40,16],[42,4,41,2],[43,4,43,2],[43,10,43,8,"exceptions"],[43,20,43,18],[43,23,43,21,"event"],[43,28,43,26],[43,29,43,27,"exception"],[43,38,43,36],[43,42,43,40,"event"],[43,47,43,45],[43,48,43,46,"exception"],[43,57,43,55],[43,58,43,56,"values"],[43,64,43,62],[44,4,44,2],[44,8,44,6],[44,9,44,7,"exceptions"],[44,19,44,17],[44,23,44,21],[44,24,44,22,"exceptions"],[44,34,44,32],[44,35,44,33,"length"],[44,41,44,39],[44,43,44,41],[45,6,45,4],[45,13,45,11,"event"],[45,18,45,16],[46,4,46,2],[47,4,48,2],[47,10,48,8,"html"],[47,14,48,12],[47,17,48,15,"doc"],[47,20,48,18],[47,21,48,19,"documentElement"],[47,36,48,34],[47,37,48,35,"innerHTML"],[47,46,48,44],[48,4,49,2],[48,8,49,6],[48,9,49,7,"html"],[48,13,49,11],[48,15,49,13],[49,6,50,4],[49,13,50,11,"event"],[49,18,50,16],[50,4,51,2],[51,4,53,2],[51,10,53,8,"htmlLines"],[51,19,53,17],[51,22,53,20],[51,23,53,21],[51,40,53,38],[51,42,53,40],[51,50,53,48],[51,52,53,50],[51,55,53,53,"html"],[51,59,53,57],[51,60,53,58,"split"],[51,65,53,63],[51,66,53,64],[51,70,53,68],[51,71,53,69],[51,73,53,71],[51,82,53,80],[51,83,53,81],[52,4,55,2,"exceptions"],[52,14,55,12],[52,15,55,13,"forEach"],[52,22,55,20],[52,23,55,21,"exception"],[52,32,55,30],[52,36,55,34],[53,6,56,4],[53,12,56,10,"stacktrace"],[53,22,56,20],[53,25,56,23,"exception"],[53,34,56,32],[53,35,56,33,"stacktrace"],[53,45,56,43],[54,6,57,4],[54,10,57,8,"stacktrace"],[54,20,57,18],[54,24,57,22,"stacktrace"],[54,34,57,32],[54,35,57,33,"frames"],[54,41,57,39],[54,43,57,41],[55,8,58,6,"stacktrace"],[55,18,58,16],[55,19,58,17,"frames"],[55,25,58,23],[55,28,58,26,"stacktrace"],[55,38,58,36],[55,39,58,37,"frames"],[55,45,58,43],[55,46,58,44,"map"],[55,49,58,47],[55,50,58,48,"frame"],[55,55,58,53],[55,59,59,8,"applySourceContextToFrame"],[55,84,59,33],[55,85,59,34,"frame"],[55,90,59,39],[55,92,59,41,"htmlLines"],[55,101,59,50],[55,103,59,52,"htmlFilename"],[55,115,59,64],[55,117,59,66,"contextLines"],[55,129,59,78],[55,130,60,6],[55,131,60,7],[56,6,61,4],[57,4,62,2],[57,5,62,3],[57,6,62,4],[58,4,64,2],[58,11,64,9,"event"],[58,16,64,14],[59,2,65,0],[61,2,67,0],[62,0,68,0],[63,0,69,0],[64,2,70,0],[64,11,70,9,"applySourceContextToFrame"],[64,36,70,34,"applySourceContextToFrame"],[64,37,71,2,"frame"],[64,42,71,7],[64,44,72,2,"htmlLines"],[64,53,72,11],[64,55,73,2,"htmlFilename"],[64,67,73,14],[64,69,74,2,"linesOfContext"],[64,83,74,16],[64,85,75,2],[65,4,76,2],[65,8,76,6,"frame"],[65,13,76,11],[65,14,76,12,"filename"],[65,22,76,20],[65,27,76,25,"htmlFilename"],[65,39,76,37],[65,43,76,41],[65,44,76,42,"frame"],[65,49,76,47],[65,50,76,48,"lineno"],[65,56,76,54],[65,60,76,58],[65,61,76,59,"htmlLines"],[65,70,76,68],[65,71,76,69,"length"],[65,77,76,75],[65,79,76,77],[66,6,77,4],[66,13,77,11,"frame"],[66,18,77,16],[67,4,78,2],[68,4,80,2],[68,8,80,2,"addContextToFrame"],[68,31,80,19],[68,33,80,20,"htmlLines"],[68,42,80,29],[68,44,80,31,"frame"],[68,49,80,36],[68,51,80,38,"linesOfContext"],[68,65,80,52],[68,66,80,53],[69,4,82,2],[69,11,82,9,"frame"],[69,16,82,14],[70,2,83,0],[71,0,83,1],[71,3]],"functionMap":{"names":["<global>","_contextLinesIntegration","processEvent","addSourceContext","exceptions.forEach$argument_0","stacktrace.frames.map$argument_0","applySourceContextToFrame"],"mappings":"AAA;kCCQ;ICK;KDE;CDE;AGkB;qBCmB;gDCG;+EDC;GDG;CHG;AMK;CNa"}},"type":"js/module"}]}